                                if (subSection.subTitle) {
                                    subContent += `<h4>${subSection.subTitle}</h4>`;
                                }
                                
                                // 处理项目列表
                                if (subSection.items && Array.isArray(subSection.items)) {
                                    subContent += '<ul>';
                                    subSection.items.forEach(item => {
                                        if (typeof item === 'string') {
                                            subContent += `<li>${item}</li>`;
                                        } else if (typeof item === 'object') {
                                            let itemContent = '';
                                            if (item.source) itemContent += `<strong>${item.source}</strong>: `;
                                            if (item.description) itemContent += item.description;
                                            
                                            // 处理链接
                                            if (item.link) {
                                                if (typeof item.link === 'string') {
                                                    itemContent += ` <a href="${item.link}" target="_blank">链接</a>`;
                                                } else if (typeof item.link === 'object') {
                                                    itemContent += ` <a href="${item.link.url || '#'}" target="_blank">${item.link.text || '链接'}</a>`;
                                                }
                                            }
                                            
                                            subContent += `<li>${itemContent}</li>`;
                                        }
                                    });
                                    subContent += '</ul>';
                                }
                                
                                sections.push({
                                    title: subSection.subTitle || '子部分',
                                    content: subContent
                                });
                            });
                        }
                    } else if (jsonData.content) {
                        // 处理单独的内容
                        sections.push({
                            title: '内容',
                            content: jsonData.content
                        });
                    } else {
                        // 对于其他未处理的结构，以卡片形式展示主要内容
                        for (const key in jsonData) {
                            if (key !== 'title' && key !== 'reportTitle' && key !== 'date' && key !== 'reportDate') {
                                if (typeof jsonData[key] === 'string') {
                                    sections.push({
                                        title: key.charAt(0).toUpperCase() + key.slice(1),
                                        content: jsonData[key]
                                    });
                                } else if (Array.isArray(jsonData[key])) {
                                    let itemsContent = '<ul>';
                                    jsonData[key].forEach(item => {
                                        if (typeof item === 'string') {
                                            itemsContent += `<li>${item}</li>`;
                                        } else if (typeof item === 'object') {
                                            itemsContent += `<li>${objectToHTML(item)}</li>`;
                                        }
                                    });
                                    itemsContent += '</ul>';
                                    
                                    sections.push({
                                        title: formatFieldName(key),
                                        content: itemsContent
                                    });
                                } else if (typeof jsonData[key] === 'object') {
                                    // 递归处理嵌套对象，使用objectToHTML
                                    sections.push({
                                        title: formatFieldName(key),
                                        content: objectToHTML(jsonData[key])
                                    });
                                }
                            }
                        }
                    }
                } else {
                    // 处理HTML内容
                    const tempDiv = document.createElement('div');
                    tempDiv.innerHTML = content;
                    
                    // 查找所有section元素
                    const sectionElements = tempDiv.querySelectorAll('.section');
                    if (sectionElements.length > 0) {
                        sectionElements.forEach(section => {
                            const titleEl = section.querySelector('h2');
                            const title = titleEl ? titleEl.textContent : '未命名部分';
                            
                            // 复制section内容，但移除h2标题
                            const sectionCopy = section.cloneNode(true);
                            const titleInCopy = sectionCopy.querySelector('h2');
                            if (titleInCopy) {
                                titleInCopy.remove();
                            }
                            
                            sections.push({
                                title: title,
                                content: sectionCopy.innerHTML
                            });
                        });
                    } else {
                        // 如果找不到section元素，尝试提取header
                        const header = tempDiv.querySelector('.header');
                        if (header) {
                            sections.push({
                                title: '标题',
                                content: header.innerHTML
                            });
                            
                            // 移除header后的其余内容
                            header.remove();
                            if (tempDiv.innerHTML.trim()) {
                                sections.push({
                                    title: '内容',
                                    content: tempDiv.innerHTML
                                });
                            }
                        } else {
                            // 没有结构，整体作为一个部分
                            sections.push({
                                title: '日报内容',
                                content: content
                            });
                        }
                    }
                }
                
                // 如果没有找到任何部分，显示默认信息
                if (sections.length === 0) {
                    sections.push({
                        title: '日报内容',
                        content: '未找到可分段的内容'
                    });
                }
                
                // 创建卡片
                const cardContainer = document.createElement('div');
                cardContainer.className = 'card-container';
                
                // 添加卡片内容
                sections.forEach((section, index) => {
                    const card = document.createElement('div');
                    card.className = 'card';
                    card.innerHTML = `
                        <h2>${section.title}</h2>
                        <div class="card-content">${section.content}</div>
                    `;
                    cardContainer.appendChild(card);
                });
                
                // 添加卡片导航
                const cardNavigation = document.createElement('div');
                cardNavigation.className = 'card-navigation';
                cardNavigation.innerHTML = `
                    <button class="nav-button prev-btn" ${sections.length <= 1 ? 'disabled' : ''}>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M15 6L9 12L15 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        上一张
                    </button>
                    <div class="card-counter">1/${sections.length}</div>
                    <button class="nav-button next-btn" ${sections.length <= 1 ? 'disabled' : ''}>
                        下一张
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M9 6L15 12L9 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </button>
                `;
                
                // 添加指示点
                const cardIndicator = document.createElement('div');
                cardIndicator.className = 'card-indicator';
                
                for (let i = 0; i < sections.length; i++) {
                    const dot = document.createElement('div');
                    dot.className = i === 0 ? 'indicator-dot active' : 'indicator-dot';
                    dot.setAttribute('data-index', i);
                    cardIndicator.appendChild(dot);
                }
                
                // 添加元素到容器
                container.appendChild(cardContainer);
                container.appendChild(cardNavigation);
                container.appendChild(cardIndicator);
                
                // 保存当前卡片索引
                container.setAttribute('data-current-card', '0');
                
                // 初始只显示第一张卡片
                const cards = cardContainer.querySelectorAll('.card');
                if (cards.length > 1) {
                    for (let i = 1; i < cards.length; i++) {
                        cards[i].style.display = 'none';
                    }
                }
                
                // 设置导航事件
                setupCardNavigation(container, sections.length);
            }
            
            // 设置卡片导航事件
            function setupCardNavigation(container, totalCards) {
                if (totalCards <= 1) return; // 只有一张卡片不需要导航
                
                const prevBtn = container.querySelector('.prev-btn');
                const nextBtn = container.querySelector('.next-btn');
                const indicators = container.querySelectorAll('.indicator-dot');
                const cardCounter = container.querySelector('.card-counter');
                
                // 上一张按钮点击事件
                prevBtn.addEventListener('click', function() {
                    navigateCards(container, -1, totalCards);
                });
                
                // 下一张按钮点击事件
                nextBtn.addEventListener('click', function() {
                    navigateCards(container, 1, totalCards);
                });
                
                // 指示点点击事件
                indicators.forEach(dot => {
                    dot.addEventListener('click', function() {
                        const targetIndex = parseInt(this.getAttribute('data-index'));
                        const currentIndex = parseInt(container.getAttribute('data-current-card'));
                        navigateToCard(container, targetIndex, currentIndex, totalCards);
                    });
                });
                
                // 添加触摸滑动支持
                const cardContainer = container.querySelector('.card-container');
                let touchStartX = 0;
                let touchEndX = 0;
                
                cardContainer.addEventListener('touchstart', function(e) {
                    touchStartX = e.changedTouches[0].screenX;
                }, { passive: true });
                
                cardContainer.addEventListener('touchend', function(e) {
                    touchEndX = e.changedTouches[0].screenX;
                    handleSwipe();
                }, { passive: true });
                
                function handleSwipe() {
                    const swipeThreshold = 50; // 滑动阈值
                    if (touchEndX < touchStartX - swipeThreshold) {
                        // 左滑 -> 下一张
                        navigateCards(container, 1, totalCards);
                    }
                    if (touchEndX > touchStartX + swipeThreshold) {
                        // 右滑 -> 上一张
                        navigateCards(container, -1, totalCards);
                    }
                }
            }
            
            // 根据偏移量导航卡片
            function navigateCards(container, offset, totalCards) {
                const currentIndex = parseInt(container.getAttribute('data-current-card'));
                // 计算新索引，确保循环导航
                const newIndex = (currentIndex + offset + totalCards) % totalCards;
                navigateToCard(container, newIndex, currentIndex, totalCards);
            }
            
            // 导航到特定卡片
            function navigateToCard(container, targetIndex, currentIndex, totalCards) {
                // 如果目标索引等于当前索引，不做任何操作
                if (targetIndex === currentIndex) return;
                
                const cards = container.querySelectorAll('.card');
                const indicators = container.querySelectorAll('.indicator-dot');
                const cardCounter = container.querySelector('.card-counter');
                
                // 隐藏当前卡片
                cards[currentIndex].style.display = 'none';
                indicators[currentIndex].classList.remove('active');
                
                // 显示目标卡片
                cards[targetIndex].style.display = 'block';
                indicators[targetIndex].classList.add('active');
                
                // 更新计数器
                cardCounter.textContent = `${targetIndex + 1}/${totalCards}`;
                
                // 更新当前卡片索引
                container.setAttribute('data-current-card', targetIndex);
            }
            
            // 从JSON section提取内容
            function extractSectionContent(section) {
                if (!section) return '';
                
                try {
                    // 如果有直接的content字段
                    if (section.content) {
                        return section.content;
                    }
                    
                    // 处理不同类型的内容
                    if (section.type === 'header') {
                        return `<h3>${section.content || ''}</h3>`;
                    } else if (section.type === 'paragraph') {
                        return `<p>${section.content || ''}</p>`;
                    } else if (section.type === 'tutorials_and_news' && section.subSections) {
                        // 教程和新闻特殊处理
                        let html = '<div class="tutorials-news">';
                        
                        if (Array.isArray(section.subSections)) {
                            section.subSections.forEach(subSection => {
                                if (subSection.subTitle) {
                                    html += `<h4>${subSection.subTitle}</h4>`;
                                }
                                
                                if (subSection.items && Array.isArray(subSection.items)) {
                                    html += '<ul class="tutorial-items">';
                                    subSection.items.forEach(item => {
                                        if (typeof item === 'string') {
                                            html += `<li>${item}</li>`;
                                        } else if (typeof item === 'object') {
                                            let itemHTML = '<li>';
                                            if (item.source) itemHTML += `<strong>${item.source}</strong>: `;
                                            if (item.description) itemHTML += item.description;
                                            
                                            // 处理链接
                                            if (item.link) {
                                                if (typeof item.link === 'string') {
                                                    itemHTML += ` <a href="${item.link}" target="_blank">链接</a>`;
                                                } else if (typeof item.link === 'object' && item.link.url) {
                                                    itemHTML += ` <a href="${item.link.url}" target="_blank">${item.link.text || '链接'}</a>`;
                                                }
                                            }
                                            
                                            itemHTML += '</li>';
                                            html += itemHTML;
                                        }
                                    });
                                    html += '</ul>';
                                }
                            });
                        }
                        
                        html += '</div>';
                        return html;
                    } else if (section.items && Array.isArray(section.items)) {
                        // 处理项目列表
                        let html = '<ul>';
                        section.items.forEach(item => {
                            if (typeof item === 'string') {
                                html += `<li>${item}</li>`;
                            } else if (typeof item === 'object') {
                                let itemHTML = '<li>';
                                
                                if (item.title) itemHTML += `<strong>${item.title}</strong>: `;
                                if (item.content) itemHTML += item.content;
                                if (item.summary) itemHTML += item.summary;
                                if (item.message) itemHTML += item.message;
                                if (item.source) itemHTML += `<strong>${item.source}</strong>: `;
                                if (item.description) itemHTML += item.description;
                                
                                itemHTML += '</li>';
                                html += itemHTML;
                            }
                        });
                        html += '</ul>';
                        return html;
                    }
                    
                    // 对于其他类型，提取有用信息
                    let contentHTML = '<div class="section-details">';
                    let hasContent = false;
                    
                    // 遍历所有字段，尝试提取有用内容
                    for (const key in section) {
                        if (key === 'type' || key === 'icon') continue;
                        
                        if (typeof section[key] === 'string') {
                            contentHTML += `<p><strong>${formatFieldName(key)}:</strong> ${section[key]}</p>`;
                            hasContent = true;
                        } else if (Array.isArray(section[key])) {
                            contentHTML += `<p><strong>${formatFieldName(key)}:</strong></p>`;
                            contentHTML += objectToHTML(section[key]);
                            hasContent = true;
                        } else if (typeof section[key] === 'object' && section[key] !== null) {
                            contentHTML += `<p><strong>${formatFieldName(key)}:</strong></p>`;
                            contentHTML += objectToHTML(section[key]);
                            hasContent = true;
                        }
                    }
                    
                    contentHTML += '</div>';
                    
                    if (hasContent) {
                        return contentHTML;
                    }
                    
                    // 如果没有提取到内容，返回格式化的HTML视图而不是原始JSON
                    return `<div class="formatted-content">
                        <p>内容概览：</p>
                        <div class="content-preview">${objectToHTML(section)}</div>
                    </div>`;
                } catch (error) {
                    console.error('处理部分内容时出错:', error);
                    return `<div class="error-content">
                        <p>处理内容时出错: ${error.message}</p>
                        <button onclick="toggleJsonSource(this)" class="json-toggle-btn">查看原始数据</button>
                        <pre style="display: none;">${JSON.stringify(section, null, 2)}</pre>
                    </div>`;
                }
            }
            
            // 切换JSON源代码显示/隐藏
            function toggleJsonSource(button) {
                const pre = button.nextElementSibling;
                if (pre.style.display === 'none') {
                    pre.style.display = 'block';
                    button.textContent = '隐藏JSON源代码';
                } else {
                    pre.style.display = 'none';
                    button.textContent = '查看JSON源代码';
                }
            }
            
            // 格式化字段名称为更友好的显示格式
            function formatFieldName(key) {
                // 将下划线和驼峰格式转换为空格分隔的标题格式
                let formatted = key
                    // 插入空格在小写后面跟大写的情况
                    .replace(/([a-z])([A-Z])/g, '$1 $2')
                    // 替换下划线和连字符为空格
                    .replace(/[_-]/g, ' ');
                
                // 首字母大写
                return formatted.charAt(0).toUpperCase() + formatted.slice(1);
            }
            
            // 安全地将对象转换为HTML显示，避免直接显示JSON代码
            function objectToHTML(obj) {
                if (!obj || typeof obj !== 'object') {
                    return String(obj || '');
                }
                
                // 处理数组
                if (Array.isArray(obj)) {
                    if (obj.length === 0) return '<i>(空数组)</i>';
                    
                    let html = '<ul class="object-list">';
                    obj.forEach(item => {
                        if (typeof item === 'string') {
                            html += `<li>${item}</li>`;
                        } else if (typeof item === 'object' && item !== null) {
                            // 递归处理
                            html += `<li>${objectToHTML(item)}</li>`;
                        } else {
                            html += `<li>${String(item)}</li>`;
                        }
                    });
                    html += '</ul>';
                    return html;
                }
                
                // 处理对象
                const keys = Object.keys(obj);
                if (keys.length === 0) return '<i>(空对象)</i>';
                
                let html = '<div class="object-props">';
                keys.forEach(key => {
                    const value = obj[key];
                    const formattedKey = formatFieldName(key);
                    
                    if (typeof value === 'string') {
                        html += `<div><strong>${formattedKey}:</strong> ${value}</div>`;
                    } else if (typeof value === 'object' && value !== null) {
                        html += `<div><strong>${formattedKey}:</strong> ${objectToHTML(value)}</div>`;
                    } else {
                        html += `<div><strong>${formattedKey}:</strong> ${String(value)}</div>`;
                    }
                });
                html += '</div>';
                
                return html;
            }
            
            // 初始化应用
            initialize();
        });

        // 确保日报HTML结构完整
        function ensureReportStructure() {
            const contentContainer = document.getElementById('reportContent');
            console.log('检查reportContent是否存在:', contentContainer ? '存在' : '不存在');
            
            if (!contentContainer) {
                console.error('报告容器不存在，尝试创建容器元素');
                
                // 检查是否有main-content容器
                const mainContent = document.querySelector('.main-content');
                if (mainContent) {
                    console.log('找到main-content容器，在其中创建reportContent');
                    
                    // 创建报告容器
                    const newContentContainer = document.createElement('div');
                    newContentContainer.id = 'reportContent';
                    newContentContainer.className = 'content-container';
                    mainContent.appendChild(newContentContainer);
                    
                    console.log('已创建reportContent容器');
                    return true;
                } else {
                    console.error('main-content容器不存在，无法创建HTML结构');
                    return false;
                }
            }
            
            // 检查header结构
            let headerElement = contentContainer.querySelector('.header');
            if (!headerElement) {
                // 创建header
                headerElement = document.createElement('div');
                headerElement.className = 'header';
                
                // 添加标题
                const titleElement = document.createElement('h1');
                titleElement.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v2h-2zm0 4h2v6h-2z"/></svg>
                    AI自媒体创造营 日报
                `;
                headerElement.appendChild(titleElement);
                
                // 添加日期
                const dateElement = document.createElement('div');
                dateElement.className = 'date';
                dateElement.textContent = formatDate(new Date().toISOString().split('T')[0]);
                headerElement.appendChild(dateElement);
                
                // 添加到容器的开头
                if (contentContainer.firstChild) {
                    contentContainer.insertBefore(headerElement, contentContainer.firstChild);
                } else {
                    contentContainer.appendChild(headerElement);
                }
                
                console.log('已创建header结构');
            }
            
            // 确保日期元素存在
            if (!contentContainer.querySelector('.header .date')) {
                const dateElement = document.createElement('div');
                dateElement.className = 'date';
                dateElement.textContent = formatDate(new Date().toISOString().split('T')[0]);
                headerElement.appendChild(dateElement);
                console.log('已创建日期元素');
            }
            
            console.log('日报HTML结构检查完成');
            return true;
        }

        // 设置定期检查密码更新的间隔
        // setInterval(updateDailyPasswordIfNeeded, 60 * 60 * 1000); // 每小时检查一次 - 重复调用，已在上面定义
        
        // 测试函数 - 直接在控制台调用显示默认日报
        function testShowDefaultReport() {
            console.log("开始测试显示默认日报...");
            
            // 确保DEFAULT_REPORT在作用域内可见
            const testReportContent = `<div class="header">
                     <h1>
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v2h-2zm0 4h2v6h-2z"/></svg>
                        AI自媒体创造营 日报
                    </h1>
                    <div class="date">2025年3月26日 (周三)</div>
                </div>
                <div class="section">
                    <h2>AI自媒体创造营日报</h2>
                    <p>欢迎来到AI自媒体创造营日报馆！这里收录了创造营的每日动态和精彩内容。</p>
                    <p>这是一个自定义的默认日报内容，如果您看到这段文字，说明默认日报已成功加载。</p>
                    <p style="color: #ff6b6b; font-weight: bold; font-size: 18px;">这是一段醒目的红色文字用于测试。如果您能看到我，说明日报系统工作正常！</p>
                </div>`;
            
            // 检查元素存在
            const contentContainer = document.getElementById('reportContent');
            console.log("reportContent容器:", contentContainer ? "存在" : "不存在");
            
            if (!contentContainer) {
                console.log("reportContent不存在，尝试创建");
                ensureReportStructure();
            }
            
            // 获取创建后的容器
            const container = document.getElementById('reportContent');
            if (container) {
                console.log("向reportContent写入测试内容");
                container.innerHTML = testReportContent;
                console.log("内容已写入");
                
                // 检查内容是否被正确写入
                setTimeout(() => {
                    const content = document.getElementById('reportContent').innerHTML;
                    console.log("最终内容长度:", content.length);
                    console.log("内容包含测试文字:", content.includes("这是一段测试日报文字") ? "是" : "否");
                    
                    // 测试更新侧边栏
                    try {
                        updateSidebarReportList();
                        console.log("已尝试更新侧边栏");
                    } catch (e) {
                        console.error("更新侧边栏失败", e);
                    }
                }, 100);
            } else {
                console.error("无法获取或创建reportContent，测试失败");
            }
        }
        
        // 在页面加载完毕后自动执行测试
        // setTimeout(testShowDefaultReport, 2000);
    </script>
</body>
</html>